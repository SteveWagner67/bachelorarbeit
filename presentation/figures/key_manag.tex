\input{../template/macros}

\documentclass{beamer}


%%=====================================================================================
%% drawing tikz
%%=====================================================================================
%
\usepackage{tikz}
\usetikzlibrary{positioning,shapes,arrows}%
\tikzstyle{memblock} = [draw, fill=blue!20, rectangle, 
    minimum height=6em, minimum width=3em]%
\definecolor{mygray}{cmyk}{0,0,0,0.4}%
\definecolor{mydarkgray}{cmyk}{0,0,0,0.7}%
\definecolor{mylightgray}{cmyk}{0,0,0,0.1}%

%________________________________________________________________
%tikz flow chart
\tikzstyle{decision} = [diamond, draw, fill=blue!20, 
    text width=4.25em, text badly centered, node distance=2cm, inner sep=0pt]
\tikzstyle{block} = [rectangle, draw, fill=blue!20, 
     text centered, rounded corners, minimum height=1.5em] 
     
\tikzstyle{block2} = [rectangle, draw, fill=orange!20, 
     text centered, rounded corners, minimum height=1.5em] 
     
\tikzstyle{block3} = [rectangle, draw, fill=green!20, 
     text centered, rounded corners, minimum height=1.5em] 
     
\tikzstyle{rect} = [rectangle, draw, fill=blue!20, text centered, minimum
height=1.5em, minimum width=5em]
    
    
    
\tikzstyle{line} = [draw, -latex']
\tikzstyle{cloud} = [draw, ellipse,fill=red!20, node distance=2cm,
    minimum height=1em]
    
\tikzstyle{txtblk} = [above, text centered]

% Define the layers to draw the diagram
\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}

\begin{document}

\begin{tikzpicture}[node distance=3cm]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% APPLICATION				  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\node (app) at(0.5\textwidth,0) [txtblk] {\large{Application}};

% This allow to create the rectangle
\begin{pgfonlayer}{background}
	  
  	%create  the lines of the rectangle  with an offset (x,y)         
	\path (app.west |- app.north)+(-2,0.25) node (a) {};
  	\path (app.south -|  app.east)+(2,-0.25) node (b) {};      
          
    % Combine the twos nodes above for creating the rectangle      
    \path[fill=mylightgray!20,rounded corners, draw=black!50, dashed]
    (a) rectangle (b);  
            
\end{pgfonlayer}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INTERFACE					  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\path (app.south)+(0, -3) node (int) [txtblk] {\large{Interface}};

% This allow to create the rectangle
\begin{pgfonlayer}{background}
	  
  	%create  the lines of the rectangle  with an offset (x,y)         
	\path (int.west |- int.north)+(-2.25,0.25) node (c) {};
  	\path (int.south -|  int.east)+(2.25,-0.25) node (d) {};      
          
    % Combine the twos nodes above for creating the rectangle      
    \path[fill=mylightgray!20,rounded corners, draw=black!50, dashed]
    (c) rectangle (d);  
            
\end{pgfonlayer}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PROVIDER					  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\path (int.south)+(0, -3) node (prov) [txtblk] {\large{Provider}};

% This allow to create the rectangle
\begin{pgfonlayer}{background}
	  
  	%create  the lines of the rectangle  with an offset (x,y)         
	\path (prov.west |- prov.north)+(-2.25,0.25) node (e) {};
  	\path (prov.south -|  prov.east)+(2.25,-0.25) node (f) {};      
          
    % Combine the twos nodes above for creating the rectangle      
    \path[fill=mylightgray!20,rounded corners, draw=black!50, dashed]
    (e) rectangle (f);  
            
\end{pgfonlayer}


\def\underleftApp{(0.5,-0.25)}

\def\underleftInt{(0.5,-3.25)}


%Application -- Interface
\path [draw=mydarkgray, ->] \underleftApp+(2.1,0)  -- (2.6,-2.2); %-0.24
\path (2.6,-0.9) node (text1) [txtblk] {\footnotesize{Gen key1}};

\path [draw=mydarkgray, <-] \underleftApp+(3.02,0)  -- (3.52,-2.2);
\path (3.52,-1.9) node (text3) [txtblk] {\footnotesize{key1ID}};

\path [draw=mydarkgray, ->] \underleftApp+(3.94,0)  -- (4.44,-2.2);
\path (4.44,-0.9) node (text4) [txtblk] {\footnotesize{Get key1}};

\path [draw=mydarkgray, <-] \underleftApp+(4.86,0)  -- (5.36,-2.2); 
\path (5.36,-1.9) node (text5) [txtblk] {\footnotesize{key1[]}};

\path [draw=mydarkgray, ->] \underleftApp+(5.78,0)  -- (6.28,-2.2); 
\path (6.28,-0.9) node (text6) [txtblk] {\footnotesize{Del key1}};


\path [draw=mydarkgray, ->] \underleftApp+(6.70,0)  -- (7.2,-2.2);
\path (7.2,-1.4) node (text8) [txtblk] {\footnotesize{Put key2[]}};

\path [draw=mydarkgray, <-] \underleftApp+(7.6,0)  -- (8.1,-2.2);
\path (8.1,-1.9) node (text9) [txtblk] {\footnotesize{key2ID}};


%Interface -- Provider
\path [draw=mydarkgray, ->] \underleftInt+(2.1,0)  -- (2.6,-5.2);
\path (2.6,-4.2) node (text11) [txtblk] {\footnotesize{Gen key1}};

\path [draw=mydarkgray, <-] \underleftInt+(3.02,0)  -- (3.52,-5.2);
\path (3.52,-4.9) node (text15) [txtblk] {\footnotesize{key1[]}};


\end{tikzpicture}

\end{document}